<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Clipboard.ninja - Realtime Clipboard</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="icon" href="ninja16.png" type="image/png" sizes="16x16">
    <link rel="icon" href="ninja80.png" type="image/png" sizes="80x80">
    <meta name="description" content="Realtime clipboard to easily and secure share text between computers or mobile devices">
    <meta name="keywords" content="clipboard, online, real time, virtual, sharing, computer, mobile, exchange, copy, paste, transfer, secure">
    <meta name="author" content="Tim de Pater - TrafeX.nl">
</head>
<body role="document">

    <div class="container">

        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <span class="navbar-brand"><img src="ninja30.png" alt="Clipboard Ninja">Clipboard.ninja - Realtime clipboard</span>
                </div>
            </div>
        </nav>

        <p>This online clipboard makes it easy to share text between computers or mobile devices.</p>
        <ul class="nav nav-tabs" role="tablist">
            <li class="active"><a href="#howtouse" role="tab" data-toggle="tab">How to use</a></li>
            <li><a href="#privacy" role="tab" data-toggle="tab">Privacy & Security</a></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane fade in active" id="howtouse">
                <br>
                <ol>
                    <li>Open this website on both devices</li>
                    <li>Enter the sender ID on the receiving device and press connect</li>
                    <li>Type or paste the text you want to send on the sending device</li>
                    <li>See the text immediately appear on the receiving device after pressing 'send'</li>
                </ol>
            </div>
            <div class="tab-pane fade" id="privacy">
                <br>
                The following precautions are taken to make sure sensitive information can safely be sent using this website.
                <ul>
                    <li>The website is running on HTTPS which means the connection to and from the server is <strong>encrypted</strong>.</li>
                    <li>Data send and received via the website is <strong>never stored or visible on the server</strong>.</li>
                    <li>You need to be connected to the sender at the moment data is send, <strong>it's not possible to retrieve the data afterwards.</strong></li>
                </ul>
            </div>
        </div>

        <div class="alert alert-danger" role="alert" id="global-alert" style="display: none">
            Unknown error.
        </div>
        <div class="alert alert-success" role="alert" id="announce" style="display: none"></div>
        <div class="row">
            <div class="col-sm-6">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h3 id="send-header" class="panel-title">Send</h3>
                </div>
                <div class="panel-body">
                    <h4>Sender ID: <strong><span id="roomid">[connecting..]</span></strong></h4>
                    <form id="msg" action="">
                        <p>
                            <label for="text">Type or paste text below</label>
                            <textarea id="text" class="form-control" rows="3" placeholder="Enter text.."></textarea>
                        </p>
                        <button type="submit" class="btn btn-primary">Send</button>
                    </form>
                    <br>
                    <p>
                        <h4>History</h4>
                        <ul id="messages"></ul>
                    </p>
                </div>
            </div>
            </div>
            <div class="col-sm-6">
            <div class="panel panel-primary">
                <div class="panel-heading">
                <h3 class="panel-title">Receive</h3>
                </div>
                <div class="panel-body">
                    <form id="subscribe" action="">
                        <label for="i">Enter the sender ID to connect with</label>
                        <div class="input-group">
                            <input id="i" type="number" class="form-control" placeholder="Enter sender ID.." min="100000">
                            <span class="input-group-btn">
                                <button type="submit" class="btn btn-primary">Connect</button>
                            </span>
                        </div>
                    </form>
                    <br>
                    <p style="display: none">
                        <h4 id="subscribed-room"></h4>
                        <ul id="received-messages"></ul>
                    </p>
                </div>
            </div>
            </div>
        </div>
    <footer>
        Created by <a href="http://www.trafex.nl">Tim de Pater</a>
    </footer>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script>
        var socket = io();
        var nrReceivers = 0;

        // Listeners
        $('#msg').submit(function(){
            var msg = $('#text').val();
            socket.emit('publish', msg);
            $('#messages').prepend($('<li>').append($('<code>').html(nl2br(msg))));
            $('#text').val('');
            return false;
        });
        $('#subscribe').submit(function(){
            var roomNr = $('#i').val();
            socket.emit('join', roomNr);
            return false;
        });

        // Events
        socket.on('message', function(msg){
            $('#received-messages').prepend($('<li>').append($('<code>').html(nl2br(msg))));
        });
        socket.on('registered', function(roomId){
            $('#roomid').text(roomId);
        });
        socket.on('subscribed', function(roomId){
            $('#global-alert').slideUp();
            $('#subscribed-room').text('Received text from sender ID ' + roomId);
        });
        socket.on('subscribed-listener', function(fromRoom){
            nrReceivers++;
            $('#announce').text('A receiver connected');
            $('#announce').slideDown().delay(2000).slideUp();
            setSendHeader();
        });
        socket.on('receiver-disconnected', function(){
            nrReceivers--;
            $('#announce').text('A receiver disconnected.');
            $('#announce').slideDown().delay(2000).slideUp();
            setSendHeader();
        });
        socket.on('sender-disconnected', function(){
            $('#global-alert').text('The sender disconnected.');
            $('#global-alert').slideDown().delay(5000).slideUp();
        });

        // Connection handling
        socket.on('connect_error', function(error){
            $('#global-alert').html('<strong>Connection lost.</strong> Reconnecting..');
            $('#global-alert').slideDown();
        });
        socket.on('reconnect_failed', function(error){
            $('#global-alert').html('<strong>Reconnecting failed.</strong> Try to refresh this page in a few minutes.');
            $('#global-alert').slideDown();
        });
        socket.on('connect', function(){
            $('#global-alert').slideUp();
        });
        socket.on('reconnect', function(){
            $('#global-alert').slideUp();
        });

        // Error handling
        socket.on('global-error', function(errorMsg){
            $('#global-alert').text(errorMsg);
            $('#global-alert').slideDown();
        });

        function setSendHeader() {
            var msg = 'Send to ' + nrReceivers;
            if (1 == nrReceivers) {
                msg += ' receiver';
            } else {
                msg += ' receivers';
            }
            $('#send-header').text(msg);
        }

        function nl2br(text) {
            var htmls = [];
            var lines = text.split(/\n/);
            var tmpDiv = jQuery(document.createElement('div'));
            for (var i = 0 ; i < lines.length ; i++) {
                htmls.push(tmpDiv.text(lines[i]).html());
            }
            return htmls.join("<br>");
        }
    </script>

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-7432038-3', 'auto');
        ga('send', 'pageview');
    </script>
</body>
</html>
